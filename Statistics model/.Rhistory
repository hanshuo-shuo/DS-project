library(dplyr)
data <- read.table("data/Chile.txt")
chi <- data %>% filter(vote == "Y" | vote =="N")
chi <- na.omit(chi)
chi$outcome <- ifelse(chi$vote=="Y",1,0)
logit_1 <- glm(outcome ~ age + income + statusquo +
education + population + region +
sex + income * sex + education * sex +
statusquo * sex, family = binomial(link = "logit"), data = chi)
summary(logit_1)
library(dplyr)
data <- read.table("data/Chile.txt")
chi <- data %>% filter(vote == "Y" | vote =="N")
chi <- na.omit(chi)
chi$outcome <- ifelse(chi$vote=="Y",1,0)
logit_1 <- glm(outcome ~ age + income + statusquo +
education + population + region +
sex + income * sex + education * sex +
statusquo * sex, family = binomial(link = "logit"), data = chi)
summary(logit_1)
library(car)
Anova(logit_1)
fit2 <- glm(outcome ~ statusquo + education + sex + education * sex,
family = binomial(link = "logit"), data = chi)
fit3 <- glm(outcome ~ statusquo + education + sex,
family = binomial(link = "logit"), data = chi)
anova(fit3, fit2, test = "Chisq")
library(effects)
logit_final = glm(outcome~sex+education+statusquo,data=chi,family=binomial(link=logit))
plot(allEffects(logit_final))
S(logit_final)
Confint(logit_final) # LRT CI
confint.default(logit_final) # ward CI
probit <- glm(outcome~sex+education+statusquo, data=chi, family = binomial(link = "probit"))
summary(probit)
# multinomial logit model
library(nnet)
chile <- data[!(is.na(data$vote)),]
multi1 = multinom(as.factor(vote) ~ sex+education+statusquo, data=chile)
summary(multi1)
# proportional odds logit model
library(MASS)
m <- polr(factor(vote) ~ sex + education + statusquo , data = chile)
summary(m)
residualPlots(logit_final, layout = c(1,2))
influenceIndexPlot(logit_final, vars = c("Cook","hat"))
compareCoefs(logit_final, update(logit_final, subset=-c(1000,1560)))
# remove influential points
compareCoefs(logit_final, update(logit_final, subset=-c(1000,1560)))
# non-linearity
crPlots(logit_final)
View(chi)
test1 = glm(outcome~sex+statusquo+education+population, family = binomial, data = chi)
test2 = glm(outcome~sex+statusquo+education+as.factor(population), family = binomial, data = chi)
anova(test1, test2, test = "Chisq")
test3 <- glm(outcome ~ statusquo + as.factor(education) + population,
family = binomial, data = chi)
anova(test1, test3, test = "Chisq")
long = read.table('data/long.txt',header=TRUE)
lm <- lm(art ~ fem + mar + kid5 + phd + ment, data = long)
summary(lm)
hist(long$art)
hist(log(long$art))
View(long)
long_poisson = glm(art~fem+mar+kid5+phd+ment, data = long, family = "poisson")
S(long_poisson)
residualPlots(long_poisson, layout = c(1,3))
